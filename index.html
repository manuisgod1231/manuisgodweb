<!DOCTYPE html>
<html>
<head>
  <title>ManuisGodWeb</title>
  <style>
    body {
      background: #111;
      color: white;
      font-family: Arial;
      text-align: center;
      margin-top: 100px;
    }
    input, button {
      padding: 8px;
      margin: 5px;
      border-radius: 5px;
    }
    #mainUI, #profileUI, #ownerPanel {
      display: none;
    }
    #moneyDisplay {
      position: absolute;
      top: 10px;
      left: 10px;
      background: #222;
      padding: 6px 10px;
      border-radius: 10px;
    }
    #profileUI {
      position: absolute;
      top: 10px;
      right: 10px;
      background: #222;
      padding: 10px;
      border-radius: 10px;
    }
  </style>
</head>
<body>

  <div id="loginUI">
    <h2>Login / Register</h2>
    <input id="username" placeholder="Username"><br>
    <input id="password" placeholder="Password" type="password"><br>
    <button onclick="login()">Login</button>
    <button onclick="register()">Create Account</button>
    <p id="msg" style="color: red;"></p>
  </div>

  <div id="mainUI">
    <div id="moneyDisplay">üí∞ Money: $0</div>

    <div id="profileUI">
      <h3>Profile</h3>
      <p id="currentUserText"></p>
      <button onclick="logout()">Logout</button><br>
      <button onclick="toggleOwnerPanel()">Toggle Owner Panel</button>
    </div>

    <div id="ownerPanel" style="display:none;">
      <h3>Owner Panel</h3>
      <textarea id="accountsList" rows="5" cols="30" readonly></textarea><br>
      <input id="giveUser" placeholder="User to Give"><br>
      <input id="giveAmount" type="number" placeholder="Amount"><br>
      <button onclick="giveMoney()">Give</button>
    </div>
  </div>

  <script>
    let accounts = JSON.parse(localStorage.getItem("accounts")) || {};

    // Ensure default owner exists
    if (!accounts["manyu"]) {
      accounts["manyu"] = {
        password: "Manuufo25252265",
        money: 1000,
        role: "owner"
      };
      localStorage.setItem("accounts", JSON.stringify(accounts));
    }

    let currentUser = localStorage.getItem("currentUser");

    function login() {
      let user = document.getElementById("username").value;
      let pass = document.getElementById("password").value;
      if (accounts[user] && accounts[user].password === pass) {
        localStorage.setItem("currentUser", user);
        currentUser = user;
        showUI();
      } else {
        document.getElementById("msg").textContent = "‚ùå Invalid credentials";
      }
    }

    function register() {
      let user = document.getElementById("username").value;
      let pass = document.getElementById("password").value;
      if (!user || !pass) return alert("Please enter username and password");
      if (accounts[user]) return alert("Account already exists!");

      accounts[user] = { password: pass, money: 0, role: "user" };
      localStorage.setItem("accounts", JSON.stringify(accounts));
      alert("‚úÖ Account created! You can login now.");
    }

    function logout() {
      localStorage.removeItem("currentUser");
      location.reload();
    }

    function showUI() {
      if (!accounts[currentUser]) return logout();

      document.getElementById("loginUI").style.display = "none";
      document.getElementById("mainUI").style.display = "block";
      document.getElementById("profileUI").style.display = "block";
      document.getElementById("currentUserText").textContent = "Logged in as: " + currentUser;

      updateMoney();

      if (accounts[currentUser].role === "owner") {
        document.getElementById("ownerPanel").style.display = "none";
        document.getElementById("toggleOwnerPanel").style.display = "inline-block";
        updateAccountList();
      } else {
        document.getElementById("ownerPanel").style.display = "none";
      }
    }

    function updateMoney() {
      let m = accounts[currentUser]?.money ?? 0;
      document.getElementById("moneyDisplay").textContent = "üí∞ Money: $" + m;
    }

    function updateAccountList() {
      let text = "";
      for (let name in accounts) {
        text += `‚Ä¢ ${name}: $${accounts[name].money ?? 0}\n`;
      }
      document.getElementById("accountsList").value = text;
    }

    function giveMoney() {
      let toUser = document.getElementById("giveUser").value;
      let amount = parseInt(document.getElementById("giveAmount").value);
      if (!accounts[toUser]) return alert("User not found");
      if (isNaN(amount) || amount <= 0) return alert("Invalid amount");

      accounts[toUser].money = (accounts[toUser].money || 0) + amount;
      localStorage.setItem("accounts", JSON.stringify(accounts));
      updateMoney();
      updateAccountList();
      alert(`‚úÖ Gave $${amount} to ${toUser}`);
    }

    function toggleOwnerPanel() {
      let panel = document.getElementById("ownerPanel");
      panel.style.display = panel.style.display === "none" ? "block" : "none";
    }

    // Show UI if already logged in
    if (currentUser && accounts[currentUser]) {
      showUI();
    }
  </script>
</body>
</html>
