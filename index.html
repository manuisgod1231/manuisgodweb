<script>
  let accounts = {};
  let currentUser = null;

  function saveAccounts() {
    localStorage.setItem('accounts', JSON.stringify(accounts));
  }

  function showMainUI() {
    document.getElementById("mainUI").style.display = "block";
    document.getElementById("loginBox").style.display = "none";
    document.getElementById("welcomeMessage").textContent = `üëã Hello, ${currentUser}!`;
  }

  function showProfileButton() {
    document.getElementById("profileBtn").style.display = "block";
  }

  function hideProfileButton() {
    document.getElementById("profileBtn").style.display = "none";
  }

  function clearInputs() {
    document.getElementById("loginUsername").value = "";
    document.getElementById("loginPassword").value = "";
  }

  function login() {
    let username = document.getElementById("loginUsername").value.trim();
    let password = document.getElementById("loginPassword").value.trim();

    if (username === "" || password === "") {
      document.getElementById("outputText").textContent = "‚ö†Ô∏è Please enter both username and password.";
      return;
    }

    if (accounts[username] && accounts[username] === password) {
      currentUser = username;
      localStorage.setItem('currentUser', currentUser);
      showMainUI();
      showProfileButton();
      document.getElementById("outputText").textContent = "";
    } else {
      document.getElementById("outputText").textContent = "‚ùå Invalid username or password.";
    }
  }

  function createAccount() {
    let username = document.getElementById("loginUsername").value.trim();
    let password = document.getElementById("loginPassword").value.trim();

    if (username === "" || password === "") {
      document.getElementById("outputText").textContent = "‚ö†Ô∏è Please fill in both fields to create an account.";
      return;
    }

    if (accounts[username]) {
      document.getElementById("outputText").textContent = "‚ö†Ô∏è Account already exists.";
      return;
    }

    accounts[username] = password;
    saveAccounts();

    currentUser = username;
    localStorage.setItem('currentUser', currentUser);
    showMainUI();
    showProfileButton();

    document.getElementById("outputText").textContent = "üéâ Account created and logged in as " + username;
  }

  function logout() {
    currentUser = null;
    localStorage.removeItem('currentUser');
    document.getElementById("mainUI").style.display = "none";
    document.getElementById("loginBox").style.display = "inline-block";
    document.getElementById("outputText").textContent = "";
    hideProfileButton();
    closeProfile();
    clearInputs();
  }

  function toggleProfile() {
    const profileBox = document.getElementById("profileBox");
    profileBox.style.display = profileBox.style.display === "block" ? "none" : "block";
  }

  function closeProfile() {
    document.getElementById("profileBox").style.display = "none";
  }

  window.onload = function () {
    accounts = JSON.parse(localStorage.getItem('accounts')) || {};

    const savedUser = localStorage.getItem('currentUser');
    if (savedUser && accounts[savedUser]) {
      currentUser = savedUser;
      showMainUI();
      showProfileButton();
    }

    document.getElementById('loginBtn').addEventListener('click', login);
    document.getElementById('createAccBtn').addEventListener('click', createAccount);
    document.getElementById('profileBtn').addEventListener('click', toggleProfile);
    document.getElementById('closeProfileBtn').addEventListener('click', closeProfile);
    document.getElementById('profileLogoutBtn').addEventListener('click', logout);
  };
</script>
